import jax

jax.config.update("jax_enable_x64", True)
import jax.numpy as jnp

################################################################################
# From other packages
################################################################################
import erfa

ICRS_TO_BARY_ROT_MAT = jnp.array(erfa.ecm06(2451545.0, 0.0))  # J2000
BARY_TO_ICRS_ROT_MAT = jnp.array(ICRS_TO_BARY_ROT_MAT.T)


################################################################################
# Hard coded strings/dicts
################################################################################

all_planets = [
    "mercury",
    "venus",
    "earth",
    "mars",
    "jupiter",
    "saturn",
    "uranus",
    "neptune",
    "pluto",
]

all_planet_nums = {
    "mercury": 1,
    "venus": 2,
    "earth": 3,
    "mars": 4,
    "jupiter": 5,
    "saturn": 6,
    "uranus": 7,
    "neptune": 8,
    "pluto": 9,
    "sun": 10,
}

# These are from the JPL ephemeris comments, and are in units of AU^3 / day^2
# Pluto is still included in the main "de" ephemeris series, no other dwarf planets
# JOKES these are actually from https://ssd.jpl.nasa.gov/ftp/xfr/gm_Horizons.pck,
# which lists Earth as apparently 1% different from its de440 and de441 value??
all_planet_gms = {
    "mercury": 4.9125001948893175e-11,
    "venus": 7.2434523326441177e-10,
    "earth": 8.9970113929473456e-10,
    "mars": 9.5495488297258106e-11,
    "jupiter": 2.8253458252257912e-07,
    "saturn": 8.4597059933762889e-08,
    "uranus": 1.2920265649682398e-08,
    "neptune": 1.5243573478851935e-08,
    "pluto": 2.1750964648933581e-12,
    "sun": 2.9591220828411951e-04,
}

large_asteroids = [
    "ceres",
    "pallas",
    "juno",
    "vesta",
    "iris",
    "hygiea",
    "eunomia",
    "psyche",
    "euphrosyne",
    "europa",
    "cybele",
    "sylvia",
    "thisbe",
    "camilla",
    "davida",
    "interamnia",
]

large_asteroid_nums = {
    "ceres": 2000001,
    "pallas": 2000002,
    "juno": 2000003,
    "vesta": 2000004,
    "iris": 2000007,
    "hygiea": 2000010,
    "eunomia": 2000015,
    "psyche": 2000016,
    "euphrosyne": 2000031,
    "europa": 2000052,
    "cybele": 2000065,
    "sylvia": 2000087,
    "thisbe": 2000088,
    "camilla": 2000107,
    "davida": 2000511,
    "interamnia": 2000704,
}

large_asteroid_gms = {
    "ceres": 1.3964518123081067e-13,
    "pallas": 3.0471146330043194e-14,
    "juno": 4.2823439677995e-15,
    "vesta": 3.85480002252579e-14,
    "iris": 2.5416014973471494e-15,
    "hygiea": 1.2542530761640807e-14,
    "eunomia": 4.5107799051436795e-15,
    "psyche": 3.544500284248897e-15,
    "euphrosyne": 2.4067012218937573e-15,
    "europa": 5.982431526486983e-15,
    "cybele": 2.091717595513368e-15,
    "sylvia": 4.834560654610551e-15,
    "thisbe": 2.652943661035635e-15,
    "camilla": 3.2191392075878576e-15,
    "davida": 8.683625349228651e-15,
    "interamnia": 6.311034342087888e-15,
}

################################################################################
# Hard coded numbers
################################################################################
SPEED_OF_LIGHT = 173.14463267424034
INV_SPEED_OF_LIGHT = 1/173.14463267424034  # 1 / AU/day

(
    h0,
    h1,
    h2,
    h3,
    h4,
    h5,
    h6,
    h7,
) = (
    0.0,
    0.0562625605369221464656521910318,
    0.180240691736892364987579942780,
    0.352624717113169637373907769648,
    0.547153626330555383001448554766,
    0.734210177215410531523210605558,
    0.885320946839095768090359771030,
    0.977520613561287501891174488626,
)
H = jnp.array([h0, h1, h2, h3, h4, h5, h6, h7])
EXTENDED_H = jnp.array([h0, h1, h2, h3, h4, h5, h6, h7, 1.0])


X_CONSTANT = jnp.array(
    [
        [0, 0, 0, 0, 0, 0, 0, 0],
        [
            8.73536501697608719327253e-4,
            8.42810870138909797073995e-4,
            -1.93373538028316572052539e-4,
            9.15686185251005970161139e-5,
            -4.92114364192781804133946e-5,
            2.61824063648773806941876e-5,
            -1.20369912595882118536527e-5,
            3.26142806610109520327640e-6,
        ],
        [
            2.82923470513190904821536e-3,
            1.13512097286113704733500e-2,
            2.34530134569998262426347e-3,
            -3.88598643658253176744093e-4,
            1.55722349835424651277977e-4,
            -7.25024777673235790026848e-5,
            3.11789941208081696890327e-5,
            -8.19252307718838155825303e-6,
        ],
        [
            5.48948892070874366611041e-3,
            2.75519607166400287201214e-2,
            2.58717491501143412948632e-2,
            3.62350041260359881995503e-3,
            -4.80741030316523126814808e-4,
            1.61130463437997997278963e-4,
            -5.96690834399549215933712e-5,
            1.46760098232234084498031e-5,
        ],
        [
            8.57507324928000945385377e-3,
            4.54172756396778503838126e-2,
            5.59645410060268988342136e-2,
            3.61338999762583637673288e-2,
            3.93296088133140244581046e-3,
            -4.22173537829670759513442e-4,
            1.10544282939276962611456e-4,
            -2.35760943456166304224696e-5,
        ],
        [
            1.14438618642429438235641e-2,
            6.29070913281514913916460e-2,
            8.41159600740749185121471e-2,
            7.20525318500126142348374e-2,
            3.61295907403064226381863e-2,
            3.09754909347184116701854e-3,
            -2.52724301032199040477093e-4,
            3.84315141142362735991797e-5,
        ],
        [
            1.38594475207731443400794e-2,
            7.67691418244795181105094e-2,
            1.07315410476394890147106e-1,
            1.00150537143521040003529e-1,
            6.64057808299776682378441e-2,
            2.58598310830157924990555e-2,
            1.61155187185750369850112e-3,
            -7.51112939830394942302571e-5,
        ],
        [
            1.52547705394886520956447e-2,
            8.54289671319202367780385e-2,
            1.21173113932355164373521e-1,
            1.17724293268403445770322e-1,
            8.41593319866074668382395e-2,
            4.23407459792701914841905e-2,
            1.13432574698735996522856e-2,
            3.48794660699230583179868e-4,
        ],
    ]
)

V0_CONSTANT = jnp.array(
    [
        0,
        5.62625605369221464656522e-2,
        1.80240691736892364987580e-1,
        3.52624717113169637373908e-1,
        5.47153626330555383001449e-1,
        7.34210177215410531523211e-1,
        8.85320946839095768090360e-1,
        9.77520613561287501891174e-1,
    ]
)

XF_CONSTANT = jnp.array(
    [
        1.56250000000000000000000e-2,
        8.74647151986822351806731e-2,
        1.24656953601519089043541e-1,
        1.21874076229067808302417e-1,
        8.86610180303731265503375e-2,
        4.61165005176623131956035e-2,
        1.43146924740578792078139e-2,
        1.28704394863754851961475e-3,
    ]
)

V_CONSTANT = jnp.array(
    [
        [0, 0, 0, 0, 0, 0, 0, 0],
        [
            2.18575357793353541137256e-2,
            3.89665899549395239044452e-2,
            -6.55597715050407620077529e-3,
            3.04798799770184124205069e-3,
            -1.62835241349049877297148e-3,
            8.64084629182701980598487e-4,
            -3.96744073137271999374989e-4,
            1.07435812894572197954028e-4,
        ],
        [
            1.10901999671639700272975e-2,
            1.07403873159510296455640e-1,
            6.96282855658907538454013e-2,
            -1.11981162486376022017069e-2,
            4.96626997902394939197324e-3,
            -2.44415446648949916442942e-3,
            1.08295842554501015496390e-3,
            -2.88624645114513521559859e-4,
        ],
        [
            1.92468502040389509926801e-2,
            8.26094308963246004705021e-2,
            1.71340619133936133266874e-1,
            8.90717669497262769350160e-2,
            -1.34161650375913008027732e-2,
            5.41902739788490501764685e-3,
            -2.21921081847769130945786e-3,
            5.72398387327762803419550e-4,
        ],
        [
            1.26546024602818595698598e-2,
            1.00477715179390448125652e-1,
            1.39818036027995551839709e-1,
            2.09454969093114337040955e-1,
            9.43551795688308622003237e-2,
            -1.29068865012407514187673e-2,
            4.34628918759383697796874e-3,
            -1.04627868541076133425182e-3,
        ],
        [
            1.80423537825988996342042e-2,
            8.64981764844820974391776e-2,
            1.61035336077435142597439e-1,
            1.75627750474135571446899e-1,
            2.16108569563255835076033e-1,
            8.46772159181207148346941e-2,
            -9.74806918951167399370458e-3,
            1.96884410489394448846786e-3,
        ],
        [
            1.37529255055574535957939e-2,
            9.74028947754815325446089e-2,
            1.45458253424969561940319e-1,
            1.96834173542642553639781e-1,
            1.84509507763066732846154e-1,
            1.90273565438552602018761e-1,
            6.15160452296466765026733e-2,
            -4.42641884082134499773214e-3,
        ],
        [
            1.68488207256304551919006e-2,
            8.96096640523487103406822e-2,
            1.56288619973402406238599e-1,
            1.82958731677264156622783e-1,
            2.02279157322782537796746e-1,
            1.65438387613399258816982e-1,
            1.35645648716948118439368e-1,
            2.84515834795118584441132e-2,
        ],
    ]
)

VF_CONSTANT = jnp.array(
    [
        1.56250000000000000000000e-2,
        9.26790774014896392703645e-2,
        1.52065310323392564487872e-1,
        1.88258772694559278286065e-1,
        1.95786083726246796541250e-1,
        1.73507397817250640114338e-1,
        1.24823950664932481628935e-1,
        5.72544073721285996711769e-2,
    ]
)

B6_CONSTANT = jnp.array(
    [
        -804.37500000000000,
        1903.11483395594192,
        -2271.99204212951950,
        2246.48860318422724,
        -1916.08560465047533,
        1381.90033871784517,
        -769.90929430944616,
        230.858165231426653,
    ]
)
