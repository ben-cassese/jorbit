import jax

jax.config.update("jax_enable_x64", True)
import jax.numpy as jnp

################################################################################
# Misc constants
################################################################################

JORBIT_EPOCH = 1.0

SPEED_OF_LIGHT = 173.14463267424034
INV_SPEED_OF_LIGHT = 1 / 173.14463267424034  # 1 / AU/day

################################################################################
# Ephemeris constants
################################################################################

# These are from the JPL ephemeris comments, and are in units of AU^3 / day^2
# Pluto is still included in the main "de" ephemeris series, no other dwarf planets
# JOKES these are actually from https://ssd.jpl.nasa.gov/ftp/xfr/gm_Horizons.pck,
# which lists Earth as apparently 1% different from its de440 and de441 value??
ALL_PLANET_GMS = {
    "mercury": 4.9125001948893175e-11,
    "venus": 7.2434523326441177e-10,
    "earth": 8.9970113929473456e-10,
    "mars": 9.5495488297258106e-11,
    "jupiter": 2.8253458252257912e-07,
    "saturn": 8.4597059933762889e-08,
    "uranus": 1.2920265649682398e-08,
    "neptune": 1.5243573478851935e-08,
    "pluto": 2.1750964648933581e-12,
    "sun": 2.9591220828411951e-04,
}

LARGE_ASTEROID_GMS = {
    "ceres": 1.3964518123081067e-13,
    "pallas": 3.0471146330043194e-14,
    "juno": 4.2823439677995e-15,
    "vesta": 3.85480002252579e-14,
    "iris": 2.5416014973471494e-15,
    "hygiea": 1.2542530761640807e-14,
    "eunomia": 4.5107799051436795e-15,
    "psyche": 3.544500284248897e-15,
    "euphrosyne": 2.4067012218937573e-15,
    "europa": 5.982431526486983e-15,
    "cybele": 2.091717595513368e-15,
    "sylvia": 4.834560654610551e-15,
    "thisbe": 2.652943661035635e-15,
    "camilla": 3.2191392075878576e-15,
    "davida": 8.683625349228651e-15,
    "interamnia": 6.311034342087888e-15,
}

ALL_PLANET_NUMS = {
    "mercury": 1,
    "venus": 2,
    "earth": 3,
    "mars": 4,
    "jupiter": 5,
    "saturn": 6,
    "uranus": 7,
    "neptune": 8,
    "pluto": 9,
    "sun": 10,
}

LARGE_ASTEROID_NUMS = {
    "ceres": 2000001,
    "pallas": 2000002,
    "juno": 2000003,
    "vesta": 2000004,
    "iris": 2000007,
    "hygiea": 2000010,
    "eunomia": 2000015,
    "psyche": 2000016,
    "euphrosyne": 2000031,
    "europa": 2000052,
    "cybele": 2000065,
    "sylvia": 2000087,
    "thisbe": 2000088,
    "camilla": 2000107,
    "davida": 2000511,
    "interamnia": 2000704,
}

################################################################################
# Yoshida constants
################################################################################

# Taken from Section 4 of Yoshida 1990
# DOI: 10.1016/0375-9601(90)90092-3
Y4_Ws = jnp.array([1 / (2 - 2 ** (1 / 3))])

# Taken from Table 1 of Yoshida 1990
# DOI: 10.1016/0375-9601(90)90092-3
Y6_Ws = jnp.array([-0.117767998417887e1, 0.23557321335935, 0.78451361047756])

# Taken from Table 2 of Yoshida 1990
# DOI: 10.1016/0375-9601(90)90092-3
Y8_Ws = jnp.array(
    [
        0.102799849391985e0,
        -0.196061023297549e1,
        0.193813913762276e1,
        -0.158240635368243e0,
        -0.144485223686048e1,
        0.253693336566229e0,
        0.914844246229740e0,
    ]
)

# Created using the Decimal version of
# jorbit.engine.yoshida_integrator._create_yoshida_coeffs
Y4_C = jnp.array(
    [
        0.675603595979828817023843904,
        -0.17560359597982881702384390,
        -0.17560359597982881702384390,
        0.675603595979828817023843904,
    ]
)

# Created using the Decimal version of
# jorbit.engine.yoshida_integrator._create_yoshida_coeffs
Y4_D = jnp.array(
    [
        1.351207191959657634047687808,
        -1.70241438391931526809537562,
        1.351207191959657634047687808,
    ]
)

# Created using the Decimal version of
# jorbit.engine.yoshida_integrator._create_yoshida_coeffs
Y6_C = jnp.array(
    [
        0.392256805238779981959140741,
        0.510043411918454980824577660,
        -0.47105338540976005035076923,
        0.068753168252525087567050832,
        0.068753168252525087567050832,
        -0.47105338540976005035076923,
        0.510043411918454980824577660,
        0.392256805238779981959140741,
    ]
)

# Created using the Decimal version of
# jorbit.engine.yoshida_integrator._create_yoshida_coeffs
Y6_D = jnp.array(
    [
        0.78451361047755996391828148,
        0.23557321335934999773087383,
        -1.1776799841788700984324123,
        1.31518632068392027356651397,
        -1.1776799841788700984324123,
        0.23557321335934999773087383,
        0.78451361047755996391828148,
    ]
)

# Created using the Decimal version of
# jorbit.engine.yoshida_integrator._create_yoshida_coeffs
Y8_C = jnp.array(
    [
        0.457422123114870016191702006,
        0.584268791397984516011732125,
        -0.59557945014712546094592937,
        -0.80154643611436146577453598,
        0.889949251127258450511092746,
        -0.01123554767636503193273256,
        -0.92890519179175248809521292,
        0.905626460089491464033883972,
        0.905626460089491464033883972,
        -0.92890519179175248809521292,
        -0.01123554767636503193273256,
        0.889949251127258450511092746,
        -0.80154643611436146577453598,
        -0.59557945014712546094592937,
        0.584268791397984516011732125,
        0.457422123114870016191702006,
    ]
)

# Created using the Decimal version of
# jorbit.engine.yoshida_integrator._create_yoshida_coeffs
Y8_D = jnp.array(
    [
        0.91484424622974003238340401,
        0.25369333656622899964006023,
        -1.4448522368604799215319189,
        -0.1582406353682430100171529,
        1.93813913762275991103933847,
        -1.9606102329754899749048036,
        0.10279984939198499871437775,
        1.70845307078699792935339019,
        0.10279984939198499871437775,
        -1.9606102329754899749048036,
        1.93813913762275991103933847,
        -0.1582406353682430100171529,
        -1.4448522368604799215319189,
        0.25369333656622899964006023,
        0.91484424622974003238340401,
    ]
)

################################################################################
# IAS15 constants
################################################################################
IAS15_H = jnp.array(
    [
        0.0,
        0.0562625605369221464656521910318,
        0.180240691736892364987579942780,
        0.352624717113169637373907769648,
        0.547153626330555383001448554766,
        0.734210177215410531523210605558,
        0.885320946839095768090359771030,
        0.977520613561287501891174488626,
    ]
)

IAS15_RR = jnp.array(
    [
        0.0562625605369221464656522,
        0.1802406917368923649875799,
        0.1239781311999702185219278,
        0.3526247171131696373739078,
        0.2963621565762474909082556,
        0.1723840253762772723863278,
        0.5471536263305553830014486,
        0.4908910657936332365357964,
        0.3669129345936630180138686,
        0.1945289092173857456275408,
        0.7342101772154105315232106,
        0.6779476166784883850575584,
        0.5539694854785181665356307,
        0.3815854601022408941493028,
        0.1870565508848551485217621,
        0.8853209468390957680903598,
        0.8290583863021736216247076,
        0.7050802551022034031027798,
        0.5326962297259261307164520,
        0.3381673205085403850889112,
        0.1511107696236852365671492,
        0.9775206135612875018911745,
        0.9212580530243653554255223,
        0.7972799218243951369035945,
        0.6248958964481178645172667,
        0.4303669872307321188897259,
        0.2433104363458769703679639,
        0.0921996667221917338008147,
    ]
)

IAS15_C = jnp.array(
    [
        -0.0562625605369221464656522,
        0.0101408028300636299864818,
        -0.2365032522738145114532321,
        -0.0035758977292516175949345,
        0.0935376952594620658957485,
        -0.5891279693869841488271399,
        0.0019565654099472210769006,
        -0.0547553868890686864408084,
        0.4158812000823068616886219,
        -1.1362815957175395318285885,
        -0.0014365302363708915424460,
        0.0421585277212687077072973,
        -0.3600995965020568122897665,
        1.2501507118406910258505441,
        -1.8704917729329500633517991,
        0.0012717903090268677492943,
        -0.0387603579159067703699046,
        0.3609622434528459832253398,
        -1.4668842084004269643701553,
        2.9061362593084293014237913,
        -2.7558127197720458314421588,
    ]
)

IAS15_D = jnp.array(
    [
        0.0562625605369221464656522,
        0.0031654757181708292499905,
        0.2365032522738145114532321,
        0.0001780977692217433881125,
        0.0457929855060279188954539,
        0.5891279693869841488271399,
        0.0000100202365223291272096,
        0.0084318571535257015445000,
        0.2535340690545692665214616,
        1.1362815957175395318285885,
        0.0000005637641639318207610,
        0.0015297840025004658189490,
        0.0978342365324440053653648,
        0.8752546646840910912297246,
        1.8704917729329500633517991,
        0.0000000317188154017613665,
        0.0002762930909826476593130,
        0.0360285539837364596003871,
        0.5767330002770787313544596,
        2.2485887607691597933926895,
        2.7558127197720458314421588,
    ]
)

IAS15_EPSILON = 10 ** (-9)
IAS15_MIN_DT = 0.0
IAS15_SAFETY_FACTOR = 0.25
